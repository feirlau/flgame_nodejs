var egret;!function(t){function i(t,i){console.error("egret.$error(id: "+t+", msg: "+i+")")}t.$error=i;var n=function(){function t(){}var i=(__define,t);return p=i.prototype,t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=n,t.registerClass(n,"egret.Endian");var e=function(){function i(t){this.BUFFER_EXT_SIZE=0,this.EOF_byte=-1,this.EOF_code_point=-1,this._setArrayBuffer(t||new ArrayBuffer(this.BUFFER_EXT_SIZE)),this.endian=n.BIG_ENDIAN}var e=__define,r=i;return p=r.prototype,p._setArrayBuffer=function(t){this.write_position=t.byteLength,this.data=new DataView(t),this._position=0},p.setArrayBuffer=function(){},e(p,"buffer",function(){return this.data.buffer},function(t){this.data=new DataView(t)}),e(p,"dataView",function(){return this.data},function(t){this.data=t,this.write_position=t.byteLength}),e(p,"bufferOffset",function(){return this.data.byteOffset}),e(p,"position",function(){return this._position},function(t){this._position=t,this.write_position=t>this.write_position?t:this.write_position}),e(p,"length",function(){return this.write_position},function(t){this.write_position=t;var i=new Uint8Array(new ArrayBuffer(t)),n=this.data.buffer.byteLength;n>t&&(this._position=t);var e=Math.min(n,t);i.set(new Uint8Array(this.data.buffer,0,e)),this.buffer=i.buffer}),e(p,"bytesAvailable",function(){return this.data.byteLength-this._position}),p.clear=function(){this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE))},p.readBoolean=function(){return this.validate(i.SIZE_OF_BOOLEAN)?0!=this.data.getUint8(this.position++):null},p.readByte=function(){return this.validate(i.SIZE_OF_INT8)?this.data.getInt8(this.position++):null},p.readBytes=function(t,n,e){if(void 0===n&&(n=0),void 0===e&&(e=0),0==e)e=this.bytesAvailable;else if(!this.validate(e))return null;t?t.validateBuffer(n+e):t=new i(new ArrayBuffer(n+e));for(var r=0;e>r;r++)t.data.setUint8(r+n,this.data.getUint8(this.position++))},p.readDouble=function(){if(!this.validate(i.SIZE_OF_FLOAT64))return null;var t=this.data.getFloat64(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_FLOAT64,t},p.readFloat=function(){if(!this.validate(i.SIZE_OF_FLOAT32))return null;var t=this.data.getFloat32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_FLOAT32,t},p.readInt=function(){if(!this.validate(i.SIZE_OF_INT32))return null;var t=this.data.getInt32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_INT32,t},p.readShort=function(){if(!this.validate(i.SIZE_OF_INT16))return null;var t=this.data.getInt16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_INT16,t},p.readUnsignedByte=function(){return this.validate(i.SIZE_OF_UINT8)?this.data.getUint8(this.position++):null},p.readUnsignedInt=function(){if(!this.validate(i.SIZE_OF_UINT32))return null;var t=this.data.getUint32(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_UINT32,t},p.readUnsignedShort=function(){if(!this.validate(i.SIZE_OF_UINT16))return null;var t=this.data.getUint16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_UINT16,t},p.readUTF=function(){if(!this.validate(i.SIZE_OF_UINT16))return null;var t=this.data.getUint16(this.position,this.endian==n.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_UINT16,t>0?this.readUTFBytes(t):""},p.readUTFBytes=function(t){if(!this.validate(t))return null;var i=new Uint8Array(this.buffer,this.bufferOffset+this.position,t);return this.position+=t,this.decodeUTF8(i)},p.writeBoolean=function(t){this.validateBuffer(i.SIZE_OF_BOOLEAN),this.data.setUint8(this.position++,t?1:0)},p.writeByte=function(t){this.validateBuffer(i.SIZE_OF_INT8),this.data.setInt8(this.position++,t)},p.writeBytes=function(t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var e;if(!(0>i)&&!(0>n)&&(e=0==n?t.length-i:Math.min(t.length-i,n),e>0)){this.validateBuffer(e);for(var r=new DataView(t.buffer),s=i;e+i>s;s++)this.data.setUint8(this.position++,r.getUint8(s))}},p.writeDouble=function(t){this.validateBuffer(i.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_FLOAT64},p.writeFloat=function(t){this.validateBuffer(i.SIZE_OF_FLOAT32),this.data.setFloat32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_FLOAT32},p.writeInt=function(t){this.validateBuffer(i.SIZE_OF_INT32),this.data.setInt32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_INT32},p.writeShort=function(t){this.validateBuffer(i.SIZE_OF_INT16),this.data.setInt16(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_INT16},p.writeUnsignedInt=function(t){this.validateBuffer(i.SIZE_OF_UINT32),this.data.setUint32(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_UINT32},p.writeUnsignedShort=function(t){this.validateBuffer(i.SIZE_OF_UINT16),this.data.setUint16(this.position,t,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_UINT16},p.writeUTF=function(t){var e=this.encodeUTF8(t),r=e.length;this.validateBuffer(i.SIZE_OF_UINT16+r),this.data.setUint16(this.position,r,this.endian==n.LITTLE_ENDIAN),this.position+=i.SIZE_OF_UINT16,this._writeUint8Array(e,!1)},p.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},p.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},p._writeUint8Array=function(t,i){void 0===i&&(i=!0),i&&this.validateBuffer(this.position+t.length);for(var n=0;n<t.length;n++)this.data.setUint8(this.position++,t[n])},p.validate=function(i){return this.data.byteLength>0&&this._position+i<=this.data.byteLength?!0:void t.$error(1025)},p.validateBuffer=function(t,i){if(void 0===i&&(i=!1),this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this.data.byteLength<t||i){var n=new Uint8Array(new ArrayBuffer(t+this.BUFFER_EXT_SIZE)),e=Math.min(this.data.buffer.byteLength,t+this.BUFFER_EXT_SIZE);n.set(new Uint8Array(this.data.buffer,0,e)),this.buffer=n.buffer}},p.encodeUTF8=function(t){for(var i=0,n=this.stringToCodePoints(t),e=[];n.length>i;){var r=n[i++];if(this.inRange(r,55296,57343))this.encoderError(r);else if(this.inRange(r,0,127))e.push(r);else{var s,a;for(this.inRange(r,128,2047)?(s=1,a=192):this.inRange(r,2048,65535)?(s=2,a=224):this.inRange(r,65536,1114111)&&(s=3,a=240),e.push(this.div(r,Math.pow(64,s))+a);s>0;){var o=this.div(r,Math.pow(64,s-1));e.push(128+o%64),s-=1}}}return new Uint8Array(e)},p.decodeUTF8=function(t){for(var i,n=!1,e=0,r="",s=0,a=0,o=0,h=0;t.length>e;){var f=t[e++];if(f==this.EOF_byte)i=0!=a?this.decoderError(n):this.EOF_code_point;else if(0==a)this.inRange(f,0,127)?i=f:(this.inRange(f,194,223)?(a=1,h=128,s=f-192):this.inRange(f,224,239)?(a=2,h=2048,s=f-224):this.inRange(f,240,244)?(a=3,h=65536,s=f-240):this.decoderError(n),s*=Math.pow(64,a),i=null);else if(this.inRange(f,128,191))if(o+=1,s+=(f-128)*Math.pow(64,a-o),o!==a)i=null;else{var u=s,_=h;s=0,a=0,o=0,h=0,i=this.inRange(u,_,1114111)&&!this.inRange(u,55296,57343)?u:this.decoderError(n,f)}else s=0,a=0,o=0,h=0,e--,i=this.decoderError(n,f);null!==i&&i!==this.EOF_code_point&&(65535>=i?i>0&&(r+=String.fromCharCode(i)):(i-=65536,r+=String.fromCharCode(55296+(i>>10&1023)),r+=String.fromCharCode(56320+(1023&i))))}return r},p.encoderError=function(i){t.$error(1026,i)},p.decoderError=function(i,n){return i&&t.$error(1027),n||65533},p.inRange=function(t,i,n){return t>=i&&n>=t},p.div=function(t,i){return Math.floor(t/i)},p.stringToCodePoints=function(t){for(var i=[],n=0,e=t.length;n<t.length;){var r=t.charCodeAt(n);if(this.inRange(r,55296,57343))if(this.inRange(r,56320,57343))i.push(65533);else if(n==e-1)i.push(65533);else{var s=t.charCodeAt(n+1);if(this.inRange(s,56320,57343)){var a=1023&r,o=1023&s;n+=1,i.push(65536+(a<<10)+o)}else i.push(65533)}else i.push(r);n+=1}return i},i.SIZE_OF_BOOLEAN=1,i.SIZE_OF_INT8=1,i.SIZE_OF_INT16=2,i.SIZE_OF_INT32=4,i.SIZE_OF_UINT8=1,i.SIZE_OF_UINT16=2,i.SIZE_OF_UINT32=4,i.SIZE_OF_FLOAT32=4,i.SIZE_OF_FLOAT64=8,i}();t.ByteArray=e,t.registerClass(e,"egret.ByteArray")}(egret||(egret={}));